#chapter 05 실행컨텍스트와 클로저

##5.1실행컨텍스트개념

- `콜스택` : 
	- 함수 호출 시 해당함수의 호출정보가 쌓여있는 `스택`
	- 실행 가능한 자바스크립트 코드블록이 실행되는 환경
- `실행컨텍스트` : 
	- 콜 스택에 들어가는 `실행정보 하나`
	- `실행가능한 코드`를 형상화하고 구분하는 추상적인 개념(ECMAScript)
	- 실행가능한 코드블록은 대부분 `함수`
- 대부분의 프로그래머는 `함수로 실행컨텍스트`를 만든다
- 이 코드 블록 안에 변수 및 객체, 실행 가능한 코드가 들어있다
- 이 코드가 실행되면 `실행 컨텍스트`가 생성되고, 실행컨텍스트는 스택 안에 쌓이며 `제일 위에 위치하는 실행 컨텍스트가 현재 실행되고 있는 컨텍스트`다
- 현재 실행되는 컨텍스트에서 이 컨텍스트와 관련없는 코드가 실행되면, 새로운 컨텍스트가 생성되어 스택에 들어가고 제어권이 그 컨텍스트로 이동

```javascript
console.log("This is global context");
function ExContext1(){
	console.log("This is ExContext1");
};
function ExContext2(){
	ExContext1();
	console.log("This is ExContext2");
};
ExContext2();
```

//결과
//This is global contest
//This is ExContext1
//This is ExContext2
- 전역 실행 컨텍스트가 가장 먼저 실행된다
- 새로운 `함수 호출`이 발생시 `새로운 컨텍스트` 만들어지고 종료되면 반환됨
- `전역실행컨텍스트의 실행이 끝나면` 모든 실행이 끝난다

##5.2실행컨텍스트 생성과정

1) 활성객체생성

실행컨텍스트가 생성되면 활성객체 생성 :
- 실행컨텍스트가 생성되면 자바스크립트 엔진은 해당 컨텍스트에서 실행에 필요한 여러 정보를 담을 객체 생성하는데, 이를 `활성객체`라고 함
- 매개변수나 사용자가 정의한 변수 및 객체를 저장하고, 엔지 내부에서 새로 만들어진 컨텍스트로 접근 가능

2) arguments객체 생성

- 활성객체는 arguments프로퍼티로 이 arguments객체를 참조

3) 스코프 정보 생성

- 현재컨텍스트의 유효범위 나타내는 스코프 정보 생성
- 현재 실행중인 실행 컨텍스트 안에서 연결리스트와 유사한 형식으로 만들어짐
- 현재 컨텍스트의 변수뿐 아니라, 상위 실행컨텍스트의 변수도 접근 가능
- 이 리스트를 `스코프체인`이라고 함
- `[[scope]]프로퍼티`로 참조됨

4) 변수생성

- 현재실행컨텍스트 내부에서 사용되는 `지역변수의 생성`이 이루어짐
- 활성객체 안에서 호출된 함수 인자는 각각의 프로퍼티가 만들어지고 그값이 할당됨
- 값이 넘겨지지 않았다면 undefined가 할당됨
- 이 과정에서 중요한 것은 변수나 내부 함수를 단지 메모리에 생성만 한다는 점
- 초기화는 각 변수나 함수에 해당하는 표현식이 실행되기 전까지는 이루어지지 않음

5) this바인딩

- 단, this가 참조하는 객체가 없으면 전역 객체를 참조

6) 코드실행
- 하나의 실행 컨텍스트가 생성되고, 변수 객체가 만들어진 후에 코드에 있는 여러 표현식이 실행됨
- 이렇게 실행되면서 변수의 초기화 및 연산 또 다른 함수의 실행 등이 이루어 짐

##5.3스코프 체인

- `스코프`: 유효범위
- 자바스크립트에서는 함수 내의 {,}블록( for(){}, if{} )은 유효범위가 없음
- 오직 `함수`만이 유효범위의 한 단위가 됨
- 유효범위를 나타내는 스코프가 `[[scope]]프로퍼티`로 각 함수 객체 내에서 연결리스트 형식으로 관리되는데 이를 `스코프 체인`이라고 함
- 실행컨텍스트는 실행된 함수의 [[scope]]프로퍼티를 기반으로 새로운 스코프 체인을 만듦
- 예) 스코프 체인
ㅡㅡㅡㅡㅡㅡㅡㅡ

| 3 | ...       |

ㅡㅡㅡㅡㅡㅡㅡㅡ

| 2 | 변수객체2 |

ㅡㅡㅡㅡㅡㅡㅡㅡ

| 1 | 변수객체1 |

ㅡㅡㅡㅡㅡㅡㅡㅡ

| 0 | 변수객체0 |

ㅡㅡㅡㅡㅡㅡㅡㅡ





